<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cricket Grounds - d3js</title>

  <script src="https://d3js.org/d3.v4.min.js"></script>
  <!-- <script src="https://code.jquery.com/jquery-3.1.1.min.js"</script> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <!-- <link href="https://fonts.googleapis.com/css?family=IM+Fell+English+SC" rel="stylesheet"> -->
  <!-- <link href="https://fonts.googleapis.com/css?family=Old+Standard+TT" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond" rel="stylesheet">

  <style>

    h1, h3{
      /*font-family: 'IM Fell English SC', serif;*/
      font-family: 'Cormorant Garamond', serif;
      /*padding-left: 5%;
      padding-bottom: 0.5%;*/
    }

    .panel-title {
      /*font-family: 'IM Fell English SC', serif;*/
      font-family: 'Cormorant Garamond', serif;
      font-size: 24px;
      /*padding-left: 5%;
      padding-bottom: 0.5%;*/
    }

    p {
      /*font-family: 'Old Standard TT', serif;*/
      font-family: 'Roboto', sans-serif;
      /*padding-left: 5%;
      padding-right: 10%;*/
    }

    .credit {
      font-size: 11px;
    }

    div.tooltip {
      position: absolute;
      text-align: center;
      /*width: 120px;
      height: 120px;*/
      padding: 2px;
      border-radius: 50%;
      font: 10px sans-serif;
      background: darkred;
      color: white;
      /*border: 1px solid steelblue;*/
      pointer-events: none;
    }

  </style>
</head>
<body>

  <div class="container-fluid">

    <div class="row">
      <div class="col-md-12 jumbotron">

        <h1>Cricket Grounds Around the World</h2>
        <h3>Context</h3>
        <p>
          This visualisation uses <a href="https://d3js.org"> D3js </a> to draw the shapes and sizes of cricket grounds from around the world.
        </p>
        <h3>Data</h3>
        <p>
          The data points that feed in to each SVG image consist of <code>ground length</code>, <code>ground width</code> and <code>ground name</code>. It was surprisingly difficult to find the dimensions of cricket grounds on the internet. I manually measured the majority of grounds myself using the 'measure distance' option in Google Maps.
        </p>
        <h3>Interactivity</h3>
        <p>
          To show Test Match batting and bowling records for each ground, hover over the pitch (or 'click' if on mobile device). Where a
          ground hasn't hosted a test match, ODI records are used. All statistics are sourced from
          <a href="http://www.howstat.com">www.howstat.com</a>.
        </p>
      </div>
    </div>

    <div class="panel-group" id="accordion">

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseNZ">New Zealand</a>
          </h3>
        </div>
        <div id="collapseNZ" class="panel-collapse collapse in">
          <div class="panel-body">
            <div class="row country-NZ">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseAus">Australia</a>
          </h3>
        </div>
        <div id="collapseAus" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-Aus">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseUK">UK</a>
          </h3>
        </div>
        <div id="collapseUK" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-UK">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseSA">South Africa</a>
          </h3>
        </div>
        <div id="collapseSA" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-SA">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseSL">Sri Lanka</a>
          </h3>
        </div>
        <div id="collapseSL" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-SL">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseInd">India</a>
          </h3>
        </div>
        <div id="collapseInd" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-Ind">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseBan">Bangladesh</a>
          </h3>
        </div>
        <div id="collapseBan" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-Ban">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseWI">West Indies</a>
          </h3>
        </div>
        <div id="collapseWI" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-WI">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseZim">Zimbabwe</a>
          </h3>
        </div>
        <div id="collapseZim" class="panel-collapse collapse">
          <div class="panel-body">
            <div class="row country-Zim">
              <div class="col-md-12">
              </div>
            </div>
          </div>
        </div>
      </div>


    </div>

    <!-- <div class="row country-NZ">
      <div class="col-md-12">
          <h3>Cricket grounds in New Zealand</h2>
      </div>
    </div> -->

    <!-- <div class="row country-Aus">
      <div class="col-md-12">
          <h3>Cricket grounds in Australia</h2>
      </div>
    </div>

    <div class="row country-UK">
      <div class="col-md-12">
          <h3>Cricket grounds in the UK</h2>
      </div>
    </div>

    <div class="row country-SA">
      <div class="col-md-12">
          <h3>Cricket grounds in South Africa</h2>
      </div>
    </div>

    <div class="row country-SL">
      <div class="col-md-12">
          <h3>Cricket grounds in Sri Lanka</h2>
      </div>
    </div> -->

    <!-- <div class="row country-Ind">
      <div class="col-md-12">
          <h3>Cricket grounds in India</h2>
      </div>
    </div> -->

    <!-- <div class="row country-Ban">
      <div class="col-md-12">
          <h3>Cricket grounds in Bangladesh</h2>
      </div>
    </div>

  <div class="row country-WI">
    <div class="col-md-12">
        <h3>Cricket grounds in the West Indies</h2>
    </div>
  </div>

  <div class="row country-Zim">
    <div class="col-md-12">
        <h3>Cricket grounds in Zimbabwe</h2>
    </div>
  </div> -->

  <div class="credit">
    <p>This visualisation was created by
      <a href="https://conrad-mac.github.io">
        Conrad MacCormick
      </a> |
      Code available
      <a href="https://github.com/conrad-mac/d3/tree/master/cricket-grounds">here</a>.
    </p>
  </div>
</div>

  <script>
    "use strict";

    var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

    var groundHeight = 90;
    var groundWidth = 75;
    var heightPadding = 20;

    var rheight = d3.scaleLinear()
    .rangeRound([0, groundHeight]);

    var rwidth = d3.scaleLinear()
    .rangeRound([0, groundWidth]);

    var tooltip = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);

    function appendGrounds(countryID) {

      d3.csv("data.csv", type, function(error, data) {
        if (error) throw error;

        rheight.domain([0, d3.max(data, function(d) { return d.height; })]);
        rwidth.domain([0, d3.max(data, function(d) { return d.width; })]);

        var mainContainer = d3.select("div.country-" + countryID)

        var filteredData = data.filter(function(d){return d.country == countryID});

        var divContainer = mainContainer.selectAll(".groundDiv")
        .data(filteredData)
        .enter().append("div")
        .attr("class", "col-md-4 groundDiv")
        .style("height", (groundHeight * 2) + heightPadding + "px")
        .append("svg")
        .attr("width", "100%")
        .attr("height", "100%");

        var fieldContainer = divContainer.append("g")
        .attr("transform", "translate(150,100)")
        .append("ellipse")
        .attr("class", "ground")
        .attr("cx", 0)
        .attr("cy", 0)
        .attr("rx", function(d) { return rwidth(d.width); })
        .attr("ry", function(d) { return rheight(d.height); })
        .attr("fill", "#397D02")

        var boundaryContainer = divContainer.append("g")
        .attr("transform", "translate(150,100)")
        .append("ellipse")
        .attr("class", "boundary")
        .attr("cx", 0)
        .attr("cy", 0)
        .attr("rx", function(d) { return rwidth(d.width) - 3; })
        .attr("ry", function(d) { return rheight(d.height) - 3; })
        .attr("fill", "none")
        .attr("stroke", "white")
        .attr("stroke-width", 1.5)
        .attr("opacity", 0)
        .transition().duration(2000).delay(0)
        .attr("opacity", 1);

        var pitchContainer = divContainer.append("g")
        .attr("transform", "translate(150,100)")
        .append("rect")
        .attr("class", "pitch")
        .attr("x", "-1%")
        .attr("y", "-3%")
        .attr("width", "10px")
        .attr("height", "20px")
        .attr("fill", "#ad5b47")
        .attr("opacity", 1)
        // .transition().duration(2000).delay(500)
        // .attr("opacity", 1)
        .on("mouseover", function(d){
          tooltip.style("left", (d3.event.pageX - 5) + "px")
          .style("top", (d3.event.pageY - 5) + "px")
          .style("width", "1px")
          .style("height", "1px")
          .transition()
          // .duration(1000)
          .transition().ease(d3.easeBounce).duration(1000)
          .style("opacity", 0.9)
          .style("display", "display")
          .style("left", (d3.event.pageX + 17) + "px")
          .style("top", (d3.event.pageY - 78) + "px")
          .style("width", "160px")
          .style("height", "160px")
          .on("end", function(){
            tooltip.html(
              "<div class='tooltipText'><h5>Batting</h5> <p>" +
              d.batting_record_name + " (" + d.batting_record_country + ")" + "</p>" +
              "<p>" + d.batting_record_score + "</p>" +
              "<h5>Bowling</h5> <p>" + d.bowling_record_name + " (" + d.bowling_record_country + ")" + "</p>" +
              "<p>" + d.bowling_record_figures + "</p>" +
               "<div>")
          });
        })
       .on("mouseout", function(d) {
         tooltip.transition()
           .duration(100)
           .style("left", (d3.event.pageX - 5) + "px")
           .style("top", (d3.event.pageY - 5) + "px")
           .style("opacity", 0)
           .style("width", "1px")
           .style("height", "1px");

           tooltip.selectAll(".tooltipText").remove();
         })
;

        var groundText = divContainer.append("g")
        .attr("transform", "translate(150,100)")
        .append("text")
        .attr("x", 0)
        .attr("y", "25%")
        .text(function(d) {return d.ground})
        .attr("dy", "-1.5em")
        .attr("font-family", "sans-serif")
        .attr("font-size", "10px")
        .attr("fill", "white")
        .attr("text-anchor", "middle")
        .attr("opacity", 0)
        .transition().duration(2000).delay(1000)
        .attr("opacity", 1);


      });
    };
      function type(d) {
        d.height = +d.height;
        d.width = +d.width;
        return d;
      };

      var countries = ["NZ", "Aus", "SA", "UK", "SL", "Ind", "WI", "Zim", "Ban"];

      for (var i = 0; i < countries.length; i++){
        appendGrounds(countries[i]);
      }

  </script>
</body>
</html>
